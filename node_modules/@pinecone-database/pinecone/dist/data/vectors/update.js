"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.UpdateCommand = void 0;
const db_data_1 = require("../../pinecone-generated-ts-fetch/db_data");
const errors_1 = require("../../errors");
class UpdateCommand {
    apiProvider;
    namespace;
    constructor(apiProvider, namespace) {
        this.apiProvider = apiProvider;
        this.namespace = namespace;
    }
    validator = (options) => {
        if (options && !options.id && !options.filter) {
            throw new errors_1.PineconeArgumentError('You must pass a non-empty string for the `id` field or a `filter` object in order to update records.');
        }
        if (options && options.id && options.filter) {
            throw new errors_1.PineconeArgumentError('You cannot pass both an `id` and a `filter` object to update records. Use either `id` to update a single record, or `filter` to update multiple records.');
        }
    };
    async run(options) {
        this.validator(options);
        const namespace = options.namespace ?? this.namespace;
        const request = {
            id: options['id'],
            values: options['values'],
            sparseValues: options['sparseValues'],
            setMetadata: options['metadata'],
            filter: options['filter'],
            namespace,
        };
        const api = await this.apiProvider.provide();
        await api.updateVector({
            xPineconeApiVersion: db_data_1.X_PINECONE_API_VERSION,
            updateRequest: request,
        });
        return;
    }
}
exports.UpdateCommand = UpdateCommand;
//# sourceMappingURL=update.js.map